{"version":3,"file":"405.8132908f0e53d6e1cdfd.bundle.js","mappings":"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","sources":["webpack://ceritaapp/./src/api/api.js","webpack://ceritaapp/./src/model/storyModel.js","webpack://ceritaapp/./src/views/registerView.js","webpack://ceritaapp/./src/presenter/registerPresenter.js","webpack://ceritaapp/./src/auth/register.js"],"sourcesContent":["const BASE_URL = 'https://story-api.dicoding.dev/v1';\r\n\r\nexport async function registerUser(name, email, password) {\r\n  const res = await fetch(`${BASE_URL}/register`, {\r\n    method: 'POST',\r\n    headers: {'Content-Type': 'application/json'},\r\n    body: JSON.stringify({ name, email, password }),\r\n  });\r\n  return await res.json();\r\n}\r\n\r\nexport async function loginUser(email, password) {\r\n  const res = await fetch(`${BASE_URL}/login`, {\r\n    method: 'POST',\r\n    headers: {'Content-Type': 'application/json'},\r\n    body: JSON.stringify({ email, password }),\r\n  });\r\n  return await res.json();\r\n}\r\n\r\nexport async function fetchStories(token, page = 1, size = 10, location = 0) {\r\n  const url = new URL(`${BASE_URL}/stories`);\r\n  url.searchParams.set('page', page);\r\n  url.searchParams.set('size', size);\r\n  url.searchParams.set('location', location);\r\n\r\n  const res = await fetch(url.toString(), {\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  });\r\n  return await res.json();\r\n}\r\n\r\nexport async function addStory(token, description, photoFile, lat = null, lon = null) {\r\n  const formData = new FormData();\r\n  formData.append('description', description);\r\n  formData.append('photo', photoFile);\r\n  if (lat !== null) formData.append('lat', lat);\r\n  if (lon !== null) formData.append('lon', lon);\r\n\r\n  const res = await fetch(`${BASE_URL}/stories`, {\r\n    method: 'POST',\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n    body: formData,\r\n  });\r\n  return await res.json();\r\n}\r\n\r\nexport async function addStoryGuest(description, photoFile, lat = null, lon = null) {\r\n  const formData = new FormData();\r\n  formData.append('description', description);\r\n  formData.append('photo', photoFile);\r\n  if (lat !== null) formData.append('lat', lat);\r\n  if (lon !== null) formData.append('lon', lon);\r\n\r\n  const res = await fetch(`${BASE_URL}/stories/guest`, {\r\n    method: 'POST',\r\n    body: formData,\r\n  });\r\n  return await res.json();\r\n}\r\n\r\nexport async function subscribePushNotification(token, subscription) {\r\n  // Kirim hanya bagian penting subscription ke server\r\n  const filteredSubscription = {\r\n    endpoint: subscription.endpoint,\r\n    keys: {\r\n      p256dh: subscription.keys.p256dh,\r\n      auth: subscription.keys.auth,\r\n    },\r\n  };\r\n\r\n  const res = await fetch(`${BASE_URL}/notifications/subscribe`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n    body: JSON.stringify(filteredSubscription),\r\n  });\r\n  return await res.json();\r\n}\r\n\r\nexport async function unsubscribePushNotification(token, endpoint) {\r\n  const res = await fetch(`${BASE_URL}/notifications/subscribe`, {\r\n    method: 'DELETE',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n    body: JSON.stringify({ endpoint }),\r\n  });\r\n  return await res.json();\r\n}\r\n\r\nexport async function sendNotification(reportId, token) {\r\n  const res = await fetch(`${BASE_URL}/notifications/send`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n    body: JSON.stringify({ reportId }),\r\n  });\r\n  return await res.json();\r\n}","import * as api from '../api/api.js';\r\n\r\nexport function getToken() {\r\n  return localStorage.getItem('token');\r\n}\r\n\r\nexport function setToken(token) {\r\n  localStorage.setItem('token', token);\r\n}\r\n\r\nexport function removeToken() {\r\n  localStorage.removeItem('token');\r\n}\r\n\r\nexport function getUserName() {\r\n  return localStorage.getItem('userName');\r\n}\r\n\r\nexport function setUserName(name) {\r\n  localStorage.setItem('userName', name);\r\n}\r\n\r\nexport async function loginUser(email, password) {\r\n  return await api.loginUser(email, password);\r\n}\r\n\r\nexport async function registerUser(name, email, password) {\r\n  return await api.registerUser(name, email, password);\r\n}\r\n\r\nexport async function fetchStories(token, page = 1, size = 10, location = 0) {\r\n  return await api.fetchStories(token, page, size, location);\r\n}\r\n\r\nexport async function postStory(token, description, photoFile, lat, lon) {\r\n  return await api.addStory(token, description, photoFile, lat, lon);\r\n}\r\n\r\nexport async function subscribePushNotification(token, subscription) {\r\n  return await api.subscribePushNotification(token, subscription);\r\n}\r\n\r\nexport async function unsubscribePushNotification(token, endpoint) {\r\n  return await api.unsubscribePushNotification(token, endpoint);\r\n}\r\n","export default class RegisterView {\r\n  constructor(container) {\r\n    this.container = container;\r\n    this.onSubmit = null;\r\n    this.onCancel = null;\r\n    this.onAlert = null;\r\n  }\r\n\r\n  render() {\r\n    this.container.innerHTML = `\r\n      <h2>Register</h2>\r\n      <form id=\"registerForm\" class=\"story-form\" novalidate>\r\n        <div class=\"form-control\">\r\n          <label for=\"name\">Nama Lengkap:</label>\r\n          <input type=\"text\" id=\"name\" name=\"name\" placeholder=\"Masukkan nama lengkap\" required />\r\n        </div>\r\n        <div class=\"form-control\">\r\n          <label for=\"email\">Email:</label>\r\n          <input type=\"email\" id=\"email\" name=\"email\" placeholder=\"Masukkan email\" required />\r\n        </div>\r\n        <div class=\"form-control\">\r\n          <label for=\"password\">Password:</label>\r\n          <input type=\"password\" id=\"password\" name=\"password\" placeholder=\"Minimal 8 karakter\" required minlength=\"8\" />\r\n        </div>\r\n        <div class=\"form-buttons\" style=\"margin-top: 20px;\">\r\n          <button class=\"btn\" type=\"submit\">Daftar</button>\r\n          <button type=\"button\" id=\"cancel-button\" class=\"btn btn-outline\">Batal</button>\r\n        </div>\r\n      </form>\r\n    `;\r\n\r\n    this.#bindEvents();\r\n  }\r\n\r\n  #bindEvents() {\r\n    const form = this.container.querySelector('#registerForm');\r\n    const cancelBtn = this.container.querySelector('#cancel-button');\r\n\r\n    form.addEventListener('submit', e => {\r\n      e.preventDefault();\r\n      if (!form.checkValidity()) {\r\n        form.reportValidity();\r\n        return;\r\n      }\r\n\r\n      const name = form.elements['name'].value.trim();\r\n      const email = form.elements['email'].value.trim();\r\n      const password = form.elements['password'].value;\r\n\r\n      if (this.onSubmit) {\r\n        this.onSubmit(name, email, password);\r\n      }\r\n    });\r\n\r\n    cancelBtn.addEventListener('click', () => {\r\n      if (this.onCancel) this.onCancel();\r\n    });\r\n  }\r\n\r\n  showError(message) {\r\n    this.onAlert?.(message);\r\n  }\r\n\r\n  showSuccess(message) {\r\n    this.onAlert?.(message);\r\n  }\r\n}\r\n","import * as model from '../model/storyModel.js';\r\nimport { navigateTo } from '../index.js';\r\n\r\nexport default class RegisterPresenter {\r\n  constructor(view) {\r\n    this.view = view;\r\n    this.view.onSubmit = this.handleRegister.bind(this);\r\n    this.view.onCancel = this.handleCancel.bind(this);\r\n    this.view.onAlert = this.handleAlert.bind(this);\r\n  }\r\n\r\n  handleAlert(message) {\r\n    alert(message);\r\n  }\r\n\r\n  async handleRegister(name, email, password) {\r\n    try {\r\n      const result = await model.registerUser(name, email, password);\r\n      if (!result.error) {\r\n        this.view.showSuccess('Registrasi berhasil! Silakan login.');\r\n        await navigateTo('#login');\r\n      } else {\r\n        this.view.showError(`Registrasi gagal: ${result.message}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Register error:', error);\r\n      this.view.showError('Terjadi kesalahan saat registrasi, coba lagi.');\r\n    }\r\n  }\r\n\r\n  async handleCancel() {\r\n    await navigateTo('#home');\r\n  }\r\n}\r\n","import RegisterView from '../views/registerView.js';\r\nimport RegisterPresenter from '../presenter/registerPresenter.js';\r\n\r\nexport default function register(container) {\r\n  const view = new RegisterView(container);\r\n  const presenter = new RegisterPresenter(view);\r\n  view.render();\r\n}\r\n"],"names":["BASE_URL","getToken","localStorage","getItem","setToken","token","setItem","setUserName","name","async","email","password","res","fetch","method","headers","body","JSON","stringify","json","page","size","location","url","URL","searchParams","set","toString","Authorization","postStory","description","photoFile","lat","lon","formData","FormData","append","RegisterView","constructor","container","this","onSubmit","onCancel","onAlert","render","innerHTML","form","querySelector","cancelBtn","addEventListener","e","preventDefault","checkValidity","reportValidity","elements","value","trim","showError","message","showSuccess","RegisterPresenter","view","handleRegister","bind","handleCancel","handleAlert","alert","result","error","console","register"],"sourceRoot":""}