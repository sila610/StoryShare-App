"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkceritaapp"] = self["webpackChunkceritaapp"] || []).push([["src_presenter_homePresenter_js"],{

/***/ "./src/presenter/homePresenter.js":
/*!****************************************!*\
  !*** ./src/presenter/homePresenter.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ HomePresenter)\n/* harmony export */ });\n/* harmony import */ var _model_storyModel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../model/storyModel.js */ \"./src/model/storyModel.js\");\n/* harmony import */ var _utils_map_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/map.js */ \"./src/utils/map.js\");\n/* harmony import */ var _storyPresenter_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./storyPresenter.js */ \"./src/presenter/storyPresenter.js\");\n/* harmony import */ var _utils_database_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/database.js */ \"./src/utils/database.js\");\n/* harmony import */ var _utils_notification_helper_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/notification-helper.js */ \"./src/utils/notification-helper.js\");\n// src/presenter/homePresenter.js\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass HomePresenter {\r\n  constructor(container) {\r\n    this.container = container;\r\n  }\r\n\r\n  // Memastikan init dipanggil untuk memulai\r\n  async init() {\r\n    await this.loadAndRenderStories();  // Fungsi untuk menampilkan semua cerita\r\n    await this.#setupPushNotificationButton();  // Memanggil setup tombol subscribe/unsubscribe\r\n  }\r\n\r\n  // Fungsi untuk memuat semua cerita\r\n  async loadAndRenderStories() {\r\n    const token = _model_storyModel_js__WEBPACK_IMPORTED_MODULE_0__.getToken();\r\n    console.log(\"Token:\", token);\r\n\r\n    if (!token) {\r\n      this.container.innerHTML = '<p>Anda harus login terlebih dahulu untuk melihat cerita.</p>';\r\n      return;\r\n    }\r\n\r\n    this.container.innerHTML = '<h2>Loading...</h2>';\r\n\r\n    try {\r\n      // Cek koneksi internet\r\n      const isOnline = navigator.onLine;\r\n      console.log('Online status:', isOnline);\r\n      \r\n      // Coba ambil dari IndexedDB terlebih dahulu\r\n      let stories = await (0,_utils_database_js__WEBPACK_IMPORTED_MODULE_3__.getStoriesFromDB)();\r\n      console.log('Stories from IndexedDB:', stories ? stories.length : 0);\r\n      \r\n      // Jika ada data di IndexedDB, tampilkan dulu\r\n      if (stories && stories.length > 0) {\r\n        this.renderStories(stories);\r\n        console.log('Rendering stories from IndexedDB');\r\n        \r\n        // Jika offline, tambahkan pesan offline\r\n        if (!isOnline) {\r\n          const offlineMessage = document.createElement('div');\r\n          offlineMessage.style.backgroundColor = '#f8d7da';\r\n          offlineMessage.style.color = '#721c24';\r\n          offlineMessage.style.padding = '10px';\r\n          offlineMessage.style.marginBottom = '15px';\r\n          offlineMessage.style.borderRadius = '5px';\r\n          offlineMessage.style.textAlign = 'center';\r\n          offlineMessage.textContent = 'Anda sedang offline. Menampilkan data tersimpan.';\r\n          \r\n          // Tambahkan pesan di atas daftar cerita\r\n          const storyList = this.container.querySelector('.story-list');\r\n          if (storyList) {\r\n            storyList.parentNode.insertBefore(offlineMessage, storyList);\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Kemudian coba ambil dari API (jika online)\r\n      if (isOnline) {\r\n        try {\r\n          const result = await _model_storyModel_js__WEBPACK_IMPORTED_MODULE_0__.fetchStories(token, 1, 10, 1);\r\n          \r\n          if (result && result.listStory && result.listStory.length > 0) {\r\n            // Update tampilan dengan data terbaru\r\n            this.renderStories(result.listStory);\r\n            console.log('Updated stories from API');\r\n          }\r\n        } catch (apiError) {\r\n          console.error('Error fetching from API, using IndexedDB data:', apiError);\r\n          // Jika gagal dan tidak ada data di IndexedDB, tampilkan pesan error\r\n          if (!stories || stories.length === 0) {\r\n            this.container.innerHTML = `\r\n              <div style=\"text-align: center; padding: 20px;\">\r\n                <h3>Terjadi kesalahan saat memuat cerita</h3>\r\n                <p>${apiError.message}</p>\r\n                <p>Anda sedang dalam mode offline. Silakan coba lagi saat online.</p>\r\n              </div>\r\n            `;\r\n          }\r\n        }\r\n      } else {\r\n        // Jika offline dan tidak ada data di IndexedDB\r\n        if (!stories || stories.length === 0) {\r\n          this.container.innerHTML = `\r\n            <div style=\"text-align: center; padding: 20px;\">\r\n              <h3>Mode Offline</h3>\r\n              <p>Anda sedang offline dan tidak ada data cerita tersimpan.</p>\r\n              <p>Silakan hubungkan ke internet untuk melihat cerita terbaru.</p>\r\n            </div>\r\n          `;\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading stories:', error);\r\n      this.container.innerHTML = `\r\n        <div style=\"text-align: center; padding: 20px;\">\r\n          <h3>Terjadi kesalahan</h3>\r\n          <p>${error.message}</p>\r\n        </div>\r\n      `;\r\n    }\r\n  }\r\n\r\n  // Render stories di halaman\r\n  renderStories(stories) {\r\n    try {\r\n      const cards = stories\r\n        .map((story) => (0,_storyPresenter_js__WEBPACK_IMPORTED_MODULE_2__.createStoryCard)(story))\r\n        .join('');\r\n\r\n      this.container.innerHTML = `\r\n        <section style=\"text-align: center; margin-bottom: 24px;\">\r\n          <h2>Selamat Datang di StoryShare App!</h2>\r\n          <p>Bagikan kisah unik dan pengalaman Anda ...</p>\r\n        </section>\r\n\r\n        <h2 style=\"text-align: center; font-size: 28px; font-weight: 700;\">Daftar Cerita</h2>\r\n        <div class=\"story-list\">${cards}</div>\r\n        <div id=\"map\" style=\"height: 400px; margin-top: 20px;\"></div>\r\n      `;\r\n\r\n      // Inisialisasi peta dengan cerita yang memiliki lokasi\r\n      const storiesWithLocation = stories.filter(story => story.lat && story.lon);\r\n      if (storiesWithLocation.length > 0) {\r\n        // Bungkus dengan try-catch untuk menangani error leaflet\r\n        try {\r\n          (0,_utils_map_js__WEBPACK_IMPORTED_MODULE_1__.initMapWithStories)(storiesWithLocation);\r\n        } catch (mapError) {\r\n          console.error('Error initializing map:', mapError);\r\n          const mapElement = document.getElementById('map');\r\n          if (mapElement) {\r\n            mapElement.innerHTML = '<div style=\"padding: 20px; text-align: center;\">Peta tidak tersedia saat ini</div>';\r\n          }\r\n        }\r\n      }\r\n\r\n      // Tambahkan event listener untuk tombol simpan\r\n      this.#bindSaveButtons();\r\n      this.#bindDeleteButtons();\r\n    } catch (error) {\r\n      console.error('Error rendering stories:', error);\r\n      this.container.innerHTML = `\r\n        <div style=\"text-align: center; padding: 20px;\">\r\n          <h3>Terjadi kesalahan saat menampilkan cerita</h3>\r\n          <p>${error.message}</p>\r\n        </div>\r\n      `;\r\n    }\r\n  }\r\n\r\n  // Mengikat event listener ke tombol simpan\r\n  #bindSaveButtons() {\r\n    const saveButtons = this.container.querySelectorAll('.save-btn');\r\n    saveButtons.forEach(button => {\r\n      button.addEventListener('click', async (event) => {\r\n        const storyId = event.target.dataset.id;\r\n        await this.handleSaveBookmark(storyId);\r\n      });\r\n    });\r\n  }\r\n\r\n  // Mengikat event listener ke tombol hapus\r\n  #bindDeleteButtons() {\r\n    const deleteButtons = this.container.querySelectorAll('.delete-btn');\r\n    deleteButtons.forEach(button => {\r\n      button.addEventListener('click', async (event) => {\r\n        const storyId = event.target.dataset.id;\r\n        await this.deleteStory(storyId);\r\n      });\r\n    });\r\n  }\r\n\r\n  // Setup tombol subscribe/unsubscribe push notification\r\n  async #setupPushNotificationButton() {\r\n    const btn = document.getElementById('btn-subscribe-nav');\r\n    if (!btn) return;\r\n\r\n    const token = _model_storyModel_js__WEBPACK_IMPORTED_MODULE_0__.getToken(); // Pastikan token ada\r\n\r\n    // Jika token tidak ada, tombol akan dinonaktifkan\r\n    if (!token) {\r\n      btn.textContent = 'Anda harus login untuk notifikasi';\r\n      btn.disabled = true;\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Update teks tombol berdasarkan status langganan\r\n      await (0,_utils_notification_helper_js__WEBPACK_IMPORTED_MODULE_4__.updateSubscriptionButtonText)(btn);\r\n      \r\n      // Tangani klik tombol untuk subscribe atau unsubscribe\r\n      btn.onclick = async () => {\r\n        try {\r\n          // Panggil fungsi togglePushNotification dengan tombol sebagai parameter\r\n          await (0,_utils_notification_helper_js__WEBPACK_IMPORTED_MODULE_4__.togglePushNotification)(btn);\r\n          \r\n          // Update teks tombol setelah toggle\r\n          await (0,_utils_notification_helper_js__WEBPACK_IMPORTED_MODULE_4__.updateSubscriptionButtonText)(btn);\r\n        } catch (error) {\r\n          console.error('Error toggling push notification:', error);\r\n          alert('Gagal mengubah status langganan notifikasi');\r\n          btn.disabled = false;\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.error('Error setting up push notification button:', error);\r\n      btn.textContent = 'Notifikasi tidak tersedia';\r\n      btn.disabled = true;\r\n    }\r\n  }\r\n\r\n  // Menambahkan cerita ke bookmark\r\n  async handleSaveBookmark(storyId) {\r\n    try {\r\n      const stories = await (0,_utils_database_js__WEBPACK_IMPORTED_MODULE_3__.getStoriesFromDB)();\r\n      const story = stories.find(st => st.id === storyId);\r\n\r\n      if (story) {\r\n        story.saved = true;  // Tandai cerita sebagai disimpan\r\n        await (0,_utils_database_js__WEBPACK_IMPORTED_MODULE_3__.saveStoryToDB)(story);  // Simpan kembali ke IndexedDB dengan status 'saved'\r\n        alert('Cerita berhasil disimpan ke bookmark!');\r\n        \r\n        // Perbarui tampilan tombol simpan\r\n        const saveBtn = this.container.querySelector(`.save-btn[data-id=\"${storyId}\"]`);\r\n        if (saveBtn) {\r\n          saveBtn.textContent = 'Tersimpan';\r\n          saveBtn.disabled = true;\r\n        }\r\n        \r\n        // Tambahkan tombol hapus jika belum ada\r\n        const card = saveBtn.closest('.story-card');\r\n        if (card && !card.querySelector(`.delete-btn[data-id=\"${storyId}\"]`)) {\r\n          const deleteBtn = document.createElement('button');\r\n          deleteBtn.className = 'delete-btn';\r\n          deleteBtn.dataset.id = storyId;\r\n          deleteBtn.textContent = 'Hapus';\r\n          deleteBtn.addEventListener('click', () => this.deleteStory(storyId));\r\n          card.querySelector('.story-card-actions').appendChild(deleteBtn);\r\n        }\r\n      } else {\r\n        alert('Cerita tidak ditemukan.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error saving bookmark:', error);\r\n      alert('Gagal menyimpan cerita ke bookmark.');\r\n    }\r\n  }\r\n\r\n  // Menghapus cerita dari database dan memperbarui tampilan\r\n  async deleteStory(storyId) {\r\n    try {\r\n      const stories = await (0,_utils_database_js__WEBPACK_IMPORTED_MODULE_3__.getStoriesFromDB)();\r\n      const story = stories.find(st => st.id === storyId);\r\n      \r\n      if (story) {\r\n        // Ubah status saved menjadi false, bukan menghapus cerita\r\n        story.saved = false;\r\n        await (0,_utils_database_js__WEBPACK_IMPORTED_MODULE_3__.saveStoryToDB)(story);\r\n        alert('Cerita dihapus dari bookmark!');\r\n      } else {\r\n        // Jika tidak ditemukan, hapus dari IndexedDB\r\n        await (0,_utils_database_js__WEBPACK_IMPORTED_MODULE_3__.deleteStoryFromDB)(storyId);\r\n        alert('Cerita dihapus dari bookmark!');\r\n      }\r\n      \r\n      // Perbarui tampilan\r\n      await this.loadAndRenderStories();\r\n    } catch (error) {\r\n      console.error('Error deleting story:', error);\r\n      alert('Gagal menghapus cerita dari bookmark.');\r\n    }\r\n  }\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcHJlc2VudGVyL2hvbWVQcmVzZW50ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDZ0Q7QUFDSztBQUNDO0FBQ29DO0FBQ3lFO0FBQ25LO0FBQ2U7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEMsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDBEQUFjO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixvRUFBZ0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw4REFBa0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQSxxQkFBcUIsaUJBQWlCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGNBQWM7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLHdDQUF3QyxjQUFjO0FBQ3REO0FBQ0EsZUFBZSxjQUFjO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixtRUFBZTtBQUN2QztBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsb0JBQW9CO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLGlCQUFpQixpQkFBaUI7QUFDekUsa0NBQWtDLE1BQU07QUFDeEMsNENBQTRDLGlCQUFpQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsaUVBQWtCO0FBQzVCLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsbUJBQW1CO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSx3Q0FBd0MsY0FBYztBQUN0RDtBQUNBLGVBQWUsY0FBYztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsMERBQWMsSUFBSTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMkZBQTRCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IscUZBQXNCO0FBQ3RDO0FBQ0E7QUFDQSxnQkFBZ0IsMkZBQTRCO0FBQzVDLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvRUFBZ0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCLGNBQWMsaUVBQWEsVUFBVTtBQUNyQztBQUNBO0FBQ0E7QUFDQSwyRUFBMkUsUUFBUTtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSxRQUFRO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvRUFBZ0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaUVBQWE7QUFDM0I7QUFDQSxRQUFRO0FBQ1I7QUFDQSxjQUFjLHFFQUFpQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jZXJpdGFhcHAvLi9zcmMvcHJlc2VudGVyL2hvbWVQcmVzZW50ZXIuanM/MzEyNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvcHJlc2VudGVyL2hvbWVQcmVzZW50ZXIuanNcclxuaW1wb3J0ICogYXMgbW9kZWwgZnJvbSAnLi4vbW9kZWwvc3RvcnlNb2RlbC5qcyc7XHJcbmltcG9ydCB7IGluaXRNYXBXaXRoU3RvcmllcyB9IGZyb20gJy4uL3V0aWxzL21hcC5qcyc7XHJcbmltcG9ydCB7IGNyZWF0ZVN0b3J5Q2FyZCB9IGZyb20gJy4vc3RvcnlQcmVzZW50ZXIuanMnO1xyXG5pbXBvcnQgeyBzYXZlU3RvcnlUb0RCLCBnZXRTdG9yaWVzRnJvbURCLCBkZWxldGVTdG9yeUZyb21EQiB9IGZyb20gJy4uL3V0aWxzL2RhdGFiYXNlLmpzJztcclxuaW1wb3J0IHsgc3Vic2NyaWJlLCB1bnN1YnNjcmliZSwgaXNDdXJyZW50UHVzaFN1YnNjcmlwdGlvbkF2YWlsYWJsZSwgdXBkYXRlU3Vic2NyaXB0aW9uQnV0dG9uVGV4dCwgdG9nZ2xlUHVzaE5vdGlmaWNhdGlvbiB9IGZyb20gJy4uL3V0aWxzL25vdGlmaWNhdGlvbi1oZWxwZXIuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSG9tZVByZXNlbnRlciB7XHJcbiAgY29uc3RydWN0b3IoY29udGFpbmVyKSB7XHJcbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICB9XHJcblxyXG4gIC8vIE1lbWFzdGlrYW4gaW5pdCBkaXBhbmdnaWwgdW50dWsgbWVtdWxhaVxyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICBhd2FpdCB0aGlzLmxvYWRBbmRSZW5kZXJTdG9yaWVzKCk7ICAvLyBGdW5nc2kgdW50dWsgbWVuYW1waWxrYW4gc2VtdWEgY2VyaXRhXHJcbiAgICBhd2FpdCB0aGlzLiNzZXR1cFB1c2hOb3RpZmljYXRpb25CdXR0b24oKTsgIC8vIE1lbWFuZ2dpbCBzZXR1cCB0b21ib2wgc3Vic2NyaWJlL3Vuc3Vic2NyaWJlXHJcbiAgfVxyXG5cclxuICAvLyBGdW5nc2kgdW50dWsgbWVtdWF0IHNlbXVhIGNlcml0YVxyXG4gIGFzeW5jIGxvYWRBbmRSZW5kZXJTdG9yaWVzKCkge1xyXG4gICAgY29uc3QgdG9rZW4gPSBtb2RlbC5nZXRUb2tlbigpO1xyXG4gICAgY29uc29sZS5sb2coXCJUb2tlbjpcIiwgdG9rZW4pO1xyXG5cclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgdGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gJzxwPkFuZGEgaGFydXMgbG9naW4gdGVybGViaWggZGFodWx1IHVudHVrIG1lbGloYXQgY2VyaXRhLjwvcD4nO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gJzxoMj5Mb2FkaW5nLi4uPC9oMj4nO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIENlayBrb25la3NpIGludGVybmV0XHJcbiAgICAgIGNvbnN0IGlzT25saW5lID0gbmF2aWdhdG9yLm9uTGluZTtcclxuICAgICAgY29uc29sZS5sb2coJ09ubGluZSBzdGF0dXM6JywgaXNPbmxpbmUpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ29iYSBhbWJpbCBkYXJpIEluZGV4ZWREQiB0ZXJsZWJpaCBkYWh1bHVcclxuICAgICAgbGV0IHN0b3JpZXMgPSBhd2FpdCBnZXRTdG9yaWVzRnJvbURCKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdTdG9yaWVzIGZyb20gSW5kZXhlZERCOicsIHN0b3JpZXMgPyBzdG9yaWVzLmxlbmd0aCA6IDApO1xyXG4gICAgICBcclxuICAgICAgLy8gSmlrYSBhZGEgZGF0YSBkaSBJbmRleGVkREIsIHRhbXBpbGthbiBkdWx1XHJcbiAgICAgIGlmIChzdG9yaWVzICYmIHN0b3JpZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHRoaXMucmVuZGVyU3RvcmllcyhzdG9yaWVzKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnUmVuZGVyaW5nIHN0b3JpZXMgZnJvbSBJbmRleGVkREInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBKaWthIG9mZmxpbmUsIHRhbWJhaGthbiBwZXNhbiBvZmZsaW5lXHJcbiAgICAgICAgaWYgKCFpc09ubGluZSkge1xyXG4gICAgICAgICAgY29uc3Qgb2ZmbGluZU1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgIG9mZmxpbmVNZXNzYWdlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZjhkN2RhJztcclxuICAgICAgICAgIG9mZmxpbmVNZXNzYWdlLnN0eWxlLmNvbG9yID0gJyM3MjFjMjQnO1xyXG4gICAgICAgICAgb2ZmbGluZU1lc3NhZ2Uuc3R5bGUucGFkZGluZyA9ICcxMHB4JztcclxuICAgICAgICAgIG9mZmxpbmVNZXNzYWdlLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxNXB4JztcclxuICAgICAgICAgIG9mZmxpbmVNZXNzYWdlLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc1cHgnO1xyXG4gICAgICAgICAgb2ZmbGluZU1lc3NhZ2Uuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XHJcbiAgICAgICAgICBvZmZsaW5lTWVzc2FnZS50ZXh0Q29udGVudCA9ICdBbmRhIHNlZGFuZyBvZmZsaW5lLiBNZW5hbXBpbGthbiBkYXRhIHRlcnNpbXBhbi4nO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBUYW1iYWhrYW4gcGVzYW4gZGkgYXRhcyBkYWZ0YXIgY2VyaXRhXHJcbiAgICAgICAgICBjb25zdCBzdG9yeUxpc3QgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc3RvcnktbGlzdCcpO1xyXG4gICAgICAgICAgaWYgKHN0b3J5TGlzdCkge1xyXG4gICAgICAgICAgICBzdG9yeUxpc3QucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUob2ZmbGluZU1lc3NhZ2UsIHN0b3J5TGlzdCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBLZW11ZGlhbiBjb2JhIGFtYmlsIGRhcmkgQVBJIChqaWthIG9ubGluZSlcclxuICAgICAgaWYgKGlzT25saW5lKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vZGVsLmZldGNoU3Rvcmllcyh0b2tlbiwgMSwgMTAsIDEpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5saXN0U3RvcnkgJiYgcmVzdWx0Lmxpc3RTdG9yeS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0YW1waWxhbiBkZW5nYW4gZGF0YSB0ZXJiYXJ1XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyU3RvcmllcyhyZXN1bHQubGlzdFN0b3J5KTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1VwZGF0ZWQgc3RvcmllcyBmcm9tIEFQSScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGFwaUVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBmcm9tIEFQSSwgdXNpbmcgSW5kZXhlZERCIGRhdGE6JywgYXBpRXJyb3IpO1xyXG4gICAgICAgICAgLy8gSmlrYSBnYWdhbCBkYW4gdGlkYWsgYWRhIGRhdGEgZGkgSW5kZXhlZERCLCB0YW1waWxrYW4gcGVzYW4gZXJyb3JcclxuICAgICAgICAgIGlmICghc3RvcmllcyB8fCBzdG9yaWVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMjBweDtcIj5cclxuICAgICAgICAgICAgICAgIDxoMz5UZXJqYWRpIGtlc2FsYWhhbiBzYWF0IG1lbXVhdCBjZXJpdGE8L2gzPlxyXG4gICAgICAgICAgICAgICAgPHA+JHthcGlFcnJvci5tZXNzYWdlfTwvcD5cclxuICAgICAgICAgICAgICAgIDxwPkFuZGEgc2VkYW5nIGRhbGFtIG1vZGUgb2ZmbGluZS4gU2lsYWthbiBjb2JhIGxhZ2kgc2FhdCBvbmxpbmUuPC9wPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICBgO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBKaWthIG9mZmxpbmUgZGFuIHRpZGFrIGFkYSBkYXRhIGRpIEluZGV4ZWREQlxyXG4gICAgICAgIGlmICghc3RvcmllcyB8fCBzdG9yaWVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgdGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nOiAyMHB4O1wiPlxyXG4gICAgICAgICAgICAgIDxoMz5Nb2RlIE9mZmxpbmU8L2gzPlxyXG4gICAgICAgICAgICAgIDxwPkFuZGEgc2VkYW5nIG9mZmxpbmUgZGFuIHRpZGFrIGFkYSBkYXRhIGNlcml0YSB0ZXJzaW1wYW4uPC9wPlxyXG4gICAgICAgICAgICAgIDxwPlNpbGFrYW4gaHVidW5na2FuIGtlIGludGVybmV0IHVudHVrIG1lbGloYXQgY2VyaXRhIHRlcmJhcnUuPC9wPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIGA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIHN0b3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLmNvbnRhaW5lci5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMjBweDtcIj5cclxuICAgICAgICAgIDxoMz5UZXJqYWRpIGtlc2FsYWhhbjwvaDM+XHJcbiAgICAgICAgICA8cD4ke2Vycm9yLm1lc3NhZ2V9PC9wPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICBgO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gUmVuZGVyIHN0b3JpZXMgZGkgaGFsYW1hblxyXG4gIHJlbmRlclN0b3JpZXMoc3Rvcmllcykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY2FyZHMgPSBzdG9yaWVzXHJcbiAgICAgICAgLm1hcCgoc3RvcnkpID0+IGNyZWF0ZVN0b3J5Q2FyZChzdG9yeSkpXHJcbiAgICAgICAgLmpvaW4oJycpO1xyXG5cclxuICAgICAgdGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgIDxzZWN0aW9uIHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tYm90dG9tOiAyNHB4O1wiPlxyXG4gICAgICAgICAgPGgyPlNlbGFtYXQgRGF0YW5nIGRpIFN0b3J5U2hhcmUgQXBwITwvaDI+XHJcbiAgICAgICAgICA8cD5CYWdpa2FuIGtpc2FoIHVuaWsgZGFuIHBlbmdhbGFtYW4gQW5kYSAuLi48L3A+XHJcbiAgICAgICAgPC9zZWN0aW9uPlxyXG5cclxuICAgICAgICA8aDIgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogMjhweDsgZm9udC13ZWlnaHQ6IDcwMDtcIj5EYWZ0YXIgQ2VyaXRhPC9oMj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwic3RvcnktbGlzdFwiPiR7Y2FyZHN9PC9kaXY+XHJcbiAgICAgICAgPGRpdiBpZD1cIm1hcFwiIHN0eWxlPVwiaGVpZ2h0OiA0MDBweDsgbWFyZ2luLXRvcDogMjBweDtcIj48L2Rpdj5cclxuICAgICAgYDtcclxuXHJcbiAgICAgIC8vIEluaXNpYWxpc2FzaSBwZXRhIGRlbmdhbiBjZXJpdGEgeWFuZyBtZW1pbGlraSBsb2thc2lcclxuICAgICAgY29uc3Qgc3Rvcmllc1dpdGhMb2NhdGlvbiA9IHN0b3JpZXMuZmlsdGVyKHN0b3J5ID0+IHN0b3J5LmxhdCAmJiBzdG9yeS5sb24pO1xyXG4gICAgICBpZiAoc3Rvcmllc1dpdGhMb2NhdGlvbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgLy8gQnVuZ2t1cyBkZW5nYW4gdHJ5LWNhdGNoIHVudHVrIG1lbmFuZ2FuaSBlcnJvciBsZWFmbGV0XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGluaXRNYXBXaXRoU3RvcmllcyhzdG9yaWVzV2l0aExvY2F0aW9uKTtcclxuICAgICAgICB9IGNhdGNoIChtYXBFcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW5pdGlhbGl6aW5nIG1hcDonLCBtYXBFcnJvcik7XHJcbiAgICAgICAgICBjb25zdCBtYXBFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xyXG4gICAgICAgICAgaWYgKG1hcEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgbWFwRWxlbWVudC5pbm5lckhUTUwgPSAnPGRpdiBzdHlsZT1cInBhZGRpbmc6IDIwcHg7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5QZXRhIHRpZGFrIHRlcnNlZGlhIHNhYXQgaW5pPC9kaXY+JztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFRhbWJhaGthbiBldmVudCBsaXN0ZW5lciB1bnR1ayB0b21ib2wgc2ltcGFuXHJcbiAgICAgIHRoaXMuI2JpbmRTYXZlQnV0dG9ucygpO1xyXG4gICAgICB0aGlzLiNiaW5kRGVsZXRlQnV0dG9ucygpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVuZGVyaW5nIHN0b3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLmNvbnRhaW5lci5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMjBweDtcIj5cclxuICAgICAgICAgIDxoMz5UZXJqYWRpIGtlc2FsYWhhbiBzYWF0IG1lbmFtcGlsa2FuIGNlcml0YTwvaDM+XHJcbiAgICAgICAgICA8cD4ke2Vycm9yLm1lc3NhZ2V9PC9wPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICBgO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWVuZ2lrYXQgZXZlbnQgbGlzdGVuZXIga2UgdG9tYm9sIHNpbXBhblxyXG4gICNiaW5kU2F2ZUJ1dHRvbnMoKSB7XHJcbiAgICBjb25zdCBzYXZlQnV0dG9ucyA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zYXZlLWJ0bicpO1xyXG4gICAgc2F2ZUJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xyXG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZXZlbnQpID0+IHtcclxuICAgICAgICBjb25zdCBzdG9yeUlkID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaWQ7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTYXZlQm9va21hcmsoc3RvcnlJZCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBNZW5naWthdCBldmVudCBsaXN0ZW5lciBrZSB0b21ib2wgaGFwdXNcclxuICAjYmluZERlbGV0ZUJ1dHRvbnMoKSB7XHJcbiAgICBjb25zdCBkZWxldGVCdXR0b25zID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmRlbGV0ZS1idG4nKTtcclxuICAgIGRlbGV0ZUJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xyXG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZXZlbnQpID0+IHtcclxuICAgICAgICBjb25zdCBzdG9yeUlkID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaWQ7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVTdG9yeShzdG9yeUlkKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFNldHVwIHRvbWJvbCBzdWJzY3JpYmUvdW5zdWJzY3JpYmUgcHVzaCBub3RpZmljYXRpb25cclxuICBhc3luYyAjc2V0dXBQdXNoTm90aWZpY2F0aW9uQnV0dG9uKCkge1xyXG4gICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1zdWJzY3JpYmUtbmF2Jyk7XHJcbiAgICBpZiAoIWJ0bikgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHRva2VuID0gbW9kZWwuZ2V0VG9rZW4oKTsgLy8gUGFzdGlrYW4gdG9rZW4gYWRhXHJcblxyXG4gICAgLy8gSmlrYSB0b2tlbiB0aWRhayBhZGEsIHRvbWJvbCBha2FuIGRpbm9uYWt0aWZrYW5cclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgYnRuLnRleHRDb250ZW50ID0gJ0FuZGEgaGFydXMgbG9naW4gdW50dWsgbm90aWZpa2FzaSc7XHJcbiAgICAgIGJ0bi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBVcGRhdGUgdGVrcyB0b21ib2wgYmVyZGFzYXJrYW4gc3RhdHVzIGxhbmdnYW5hblxyXG4gICAgICBhd2FpdCB1cGRhdGVTdWJzY3JpcHRpb25CdXR0b25UZXh0KGJ0bik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBUYW5nYW5pIGtsaWsgdG9tYm9sIHVudHVrIHN1YnNjcmliZSBhdGF1IHVuc3Vic2NyaWJlXHJcbiAgICAgIGJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBQYW5nZ2lsIGZ1bmdzaSB0b2dnbGVQdXNoTm90aWZpY2F0aW9uIGRlbmdhbiB0b21ib2wgc2ViYWdhaSBwYXJhbWV0ZXJcclxuICAgICAgICAgIGF3YWl0IHRvZ2dsZVB1c2hOb3RpZmljYXRpb24oYnRuKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gVXBkYXRlIHRla3MgdG9tYm9sIHNldGVsYWggdG9nZ2xlXHJcbiAgICAgICAgICBhd2FpdCB1cGRhdGVTdWJzY3JpcHRpb25CdXR0b25UZXh0KGJ0bik7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHRvZ2dsaW5nIHB1c2ggbm90aWZpY2F0aW9uOicsIGVycm9yKTtcclxuICAgICAgICAgIGFsZXJ0KCdHYWdhbCBtZW5ndWJhaCBzdGF0dXMgbGFuZ2dhbmFuIG5vdGlmaWthc2knKTtcclxuICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNldHRpbmcgdXAgcHVzaCBub3RpZmljYXRpb24gYnV0dG9uOicsIGVycm9yKTtcclxuICAgICAgYnRuLnRleHRDb250ZW50ID0gJ05vdGlmaWthc2kgdGlkYWsgdGVyc2VkaWEnO1xyXG4gICAgICBidG4uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWVuYW1iYWhrYW4gY2VyaXRhIGtlIGJvb2ttYXJrXHJcbiAgYXN5bmMgaGFuZGxlU2F2ZUJvb2ttYXJrKHN0b3J5SWQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JpZXMgPSBhd2FpdCBnZXRTdG9yaWVzRnJvbURCKCk7XHJcbiAgICAgIGNvbnN0IHN0b3J5ID0gc3Rvcmllcy5maW5kKHN0ID0+IHN0LmlkID09PSBzdG9yeUlkKTtcclxuXHJcbiAgICAgIGlmIChzdG9yeSkge1xyXG4gICAgICAgIHN0b3J5LnNhdmVkID0gdHJ1ZTsgIC8vIFRhbmRhaSBjZXJpdGEgc2ViYWdhaSBkaXNpbXBhblxyXG4gICAgICAgIGF3YWl0IHNhdmVTdG9yeVRvREIoc3RvcnkpOyAgLy8gU2ltcGFuIGtlbWJhbGkga2UgSW5kZXhlZERCIGRlbmdhbiBzdGF0dXMgJ3NhdmVkJ1xyXG4gICAgICAgIGFsZXJ0KCdDZXJpdGEgYmVyaGFzaWwgZGlzaW1wYW4ga2UgYm9va21hcmshJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUGVyYmFydWkgdGFtcGlsYW4gdG9tYm9sIHNpbXBhblxyXG4gICAgICAgIGNvbnN0IHNhdmVCdG4gPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGAuc2F2ZS1idG5bZGF0YS1pZD1cIiR7c3RvcnlJZH1cIl1gKTtcclxuICAgICAgICBpZiAoc2F2ZUJ0bikge1xyXG4gICAgICAgICAgc2F2ZUJ0bi50ZXh0Q29udGVudCA9ICdUZXJzaW1wYW4nO1xyXG4gICAgICAgICAgc2F2ZUJ0bi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFRhbWJhaGthbiB0b21ib2wgaGFwdXMgamlrYSBiZWx1bSBhZGFcclxuICAgICAgICBjb25zdCBjYXJkID0gc2F2ZUJ0bi5jbG9zZXN0KCcuc3RvcnktY2FyZCcpO1xyXG4gICAgICAgIGlmIChjYXJkICYmICFjYXJkLnF1ZXJ5U2VsZWN0b3IoYC5kZWxldGUtYnRuW2RhdGEtaWQ9XCIke3N0b3J5SWR9XCJdYCkpIHtcclxuICAgICAgICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgICAgZGVsZXRlQnRuLmNsYXNzTmFtZSA9ICdkZWxldGUtYnRuJztcclxuICAgICAgICAgIGRlbGV0ZUJ0bi5kYXRhc2V0LmlkID0gc3RvcnlJZDtcclxuICAgICAgICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9ICdIYXB1cyc7XHJcbiAgICAgICAgICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLmRlbGV0ZVN0b3J5KHN0b3J5SWQpKTtcclxuICAgICAgICAgIGNhcmQucXVlcnlTZWxlY3RvcignLnN0b3J5LWNhcmQtYWN0aW9ucycpLmFwcGVuZENoaWxkKGRlbGV0ZUJ0bik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFsZXJ0KCdDZXJpdGEgdGlkYWsgZGl0ZW11a2FuLicpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgYm9va21hcms6JywgZXJyb3IpO1xyXG4gICAgICBhbGVydCgnR2FnYWwgbWVueWltcGFuIGNlcml0YSBrZSBib29rbWFyay4nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIE1lbmdoYXB1cyBjZXJpdGEgZGFyaSBkYXRhYmFzZSBkYW4gbWVtcGVyYmFydWkgdGFtcGlsYW5cclxuICBhc3luYyBkZWxldGVTdG9yeShzdG9yeUlkKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzdG9yaWVzID0gYXdhaXQgZ2V0U3Rvcmllc0Zyb21EQigpO1xyXG4gICAgICBjb25zdCBzdG9yeSA9IHN0b3JpZXMuZmluZChzdCA9PiBzdC5pZCA9PT0gc3RvcnlJZCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoc3RvcnkpIHtcclxuICAgICAgICAvLyBVYmFoIHN0YXR1cyBzYXZlZCBtZW5qYWRpIGZhbHNlLCBidWthbiBtZW5naGFwdXMgY2VyaXRhXHJcbiAgICAgICAgc3Rvcnkuc2F2ZWQgPSBmYWxzZTtcclxuICAgICAgICBhd2FpdCBzYXZlU3RvcnlUb0RCKHN0b3J5KTtcclxuICAgICAgICBhbGVydCgnQ2VyaXRhIGRpaGFwdXMgZGFyaSBib29rbWFyayEnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBKaWthIHRpZGFrIGRpdGVtdWthbiwgaGFwdXMgZGFyaSBJbmRleGVkREJcclxuICAgICAgICBhd2FpdCBkZWxldGVTdG9yeUZyb21EQihzdG9yeUlkKTtcclxuICAgICAgICBhbGVydCgnQ2VyaXRhIGRpaGFwdXMgZGFyaSBib29rbWFyayEnKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gUGVyYmFydWkgdGFtcGlsYW5cclxuICAgICAgYXdhaXQgdGhpcy5sb2FkQW5kUmVuZGVyU3RvcmllcygpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgc3Rvcnk6JywgZXJyb3IpO1xyXG4gICAgICBhbGVydCgnR2FnYWwgbWVuZ2hhcHVzIGNlcml0YSBkYXJpIGJvb2ttYXJrLicpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/presenter/homePresenter.js\n");

/***/ }),

/***/ "./src/presenter/storyPresenter.js":
/*!*****************************************!*\
  !*** ./src/presenter/storyPresenter.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bindSaveButtonsAndDeleteButtons: () => (/* binding */ bindSaveButtonsAndDeleteButtons),\n/* harmony export */   createStoryCard: () => (/* binding */ createStoryCard)\n/* harmony export */ });\n// src/presenter/storyPresenter.js\r\nfunction createStoryCard(story) {\r\n  // Pastikan ada URL gambar, gunakan placeholder jika tidak ada\r\n  let photoUrl = '/assets/place_24dp_5985E1.png'; // Default placeholder\r\n  \r\n  if (story.photoUrl) {\r\n    photoUrl = story.photoUrl;\r\n  } else if (story.photo) {\r\n    photoUrl = story.photo;\r\n  }\r\n  \r\n  const date = story.createdAt\r\n    ? new Date(story.createdAt).toLocaleDateString()\r\n    : 'Tanggal tidak tersedia';\r\n\r\n  const isSaved = story.saved === true;\r\n\r\n  return `\r\n    <div class=\"story-card\" tabindex=\"0\" data-id=\"${story.id}\">\r\n      <img src=\"${photoUrl}\" alt=\"Gambar cerita oleh ${story.name || 'Anonim'}\" \r\n           onerror=\"this.onerror=null; this.src='/assets/place_24dp_5985E1.png';\" />\r\n      <h3>${story.name || 'Anonim'}</h3>\r\n      <p>${story.description || '-'}</p>\r\n      <p><small>${date}</small></p>\r\n      <div class=\"story-card-actions\">\r\n        <button class=\"save-btn\" data-id=\"${story.id}\" ${isSaved ? 'disabled' : ''}>\r\n          ${isSaved ? 'Tersimpan' : 'Simpan'}\r\n        </button>\r\n        ${isSaved ? `<button class=\"delete-btn\" data-id=\"${story.id}\">Hapus</button>` : ''}\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Attach listener ke tombol simpan dan hapus setelah kartu dirender\r\n * @param {Function} onSaveBookmarkCallback - callback ketika tombol simpan diklik\r\n * @param {Function} onDeleteStoryCallback - callback ketika tombol hapus diklik\r\n */\r\nfunction bindSaveButtonsAndDeleteButtons(onSaveBookmarkCallback, onDeleteStoryCallback) {\r\n  const saveButtons = document.querySelectorAll('.save-btn');\r\n  const deleteButtons = document.querySelectorAll('.delete-btn');\r\n\r\n  // Mengikat event listener untuk tombol simpan\r\n  saveButtons.forEach((btn) => {\r\n    const storyId = btn.getAttribute('data-id');\r\n    if (storyId && typeof onSaveBookmarkCallback === 'function') {\r\n      btn.addEventListener('click', () => {\r\n        onSaveBookmarkCallback(storyId);\r\n      });\r\n    }\r\n  });\r\n\r\n  // Mengikat event listener untuk tombol hapus\r\n  deleteButtons.forEach((btn) => {\r\n    const storyId = btn.getAttribute('data-id');\r\n    if (storyId && typeof onDeleteStoryCallback === 'function') {\r\n      btn.addEventListener('click', () => {\r\n        onDeleteStoryCallback(storyId);\r\n      });\r\n    }\r\n  });\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcHJlc2VudGVyL3N0b3J5UHJlc2VudGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDTztBQUNQO0FBQ0Esa0RBQWtEO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxTQUFTO0FBQzdELGtCQUFrQixTQUFTLDRCQUE0Qix1QkFBdUI7QUFDOUUsdUNBQXVDLHlDQUF5QztBQUNoRixZQUFZLHVCQUF1QjtBQUNuQyxXQUFXLHlCQUF5QjtBQUNwQyxrQkFBa0IsS0FBSztBQUN2QjtBQUNBLDRDQUE0QyxTQUFTLElBQUksMEJBQTBCO0FBQ25GLFlBQVk7QUFDWjtBQUNBLFVBQVUsaURBQWlELFNBQVM7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFVBQVU7QUFDckIsV0FBVyxVQUFVO0FBQ3JCO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0giLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jZXJpdGFhcHAvLi9zcmMvcHJlc2VudGVyL3N0b3J5UHJlc2VudGVyLmpzPzY2ZTUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3ByZXNlbnRlci9zdG9yeVByZXNlbnRlci5qc1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3RvcnlDYXJkKHN0b3J5KSB7XHJcbiAgLy8gUGFzdGlrYW4gYWRhIFVSTCBnYW1iYXIsIGd1bmFrYW4gcGxhY2Vob2xkZXIgamlrYSB0aWRhayBhZGFcclxuICBsZXQgcGhvdG9VcmwgPSAnL2Fzc2V0cy9wbGFjZV8yNGRwXzU5ODVFMS5wbmcnOyAvLyBEZWZhdWx0IHBsYWNlaG9sZGVyXHJcbiAgXHJcbiAgaWYgKHN0b3J5LnBob3RvVXJsKSB7XHJcbiAgICBwaG90b1VybCA9IHN0b3J5LnBob3RvVXJsO1xyXG4gIH0gZWxzZSBpZiAoc3RvcnkucGhvdG8pIHtcclxuICAgIHBob3RvVXJsID0gc3RvcnkucGhvdG87XHJcbiAgfVxyXG4gIFxyXG4gIGNvbnN0IGRhdGUgPSBzdG9yeS5jcmVhdGVkQXRcclxuICAgID8gbmV3IERhdGUoc3RvcnkuY3JlYXRlZEF0KS50b0xvY2FsZURhdGVTdHJpbmcoKVxyXG4gICAgOiAnVGFuZ2dhbCB0aWRhayB0ZXJzZWRpYSc7XHJcblxyXG4gIGNvbnN0IGlzU2F2ZWQgPSBzdG9yeS5zYXZlZCA9PT0gdHJ1ZTtcclxuXHJcbiAgcmV0dXJuIGBcclxuICAgIDxkaXYgY2xhc3M9XCJzdG9yeS1jYXJkXCIgdGFiaW5kZXg9XCIwXCIgZGF0YS1pZD1cIiR7c3RvcnkuaWR9XCI+XHJcbiAgICAgIDxpbWcgc3JjPVwiJHtwaG90b1VybH1cIiBhbHQ9XCJHYW1iYXIgY2VyaXRhIG9sZWggJHtzdG9yeS5uYW1lIHx8ICdBbm9uaW0nfVwiIFxyXG4gICAgICAgICAgIG9uZXJyb3I9XCJ0aGlzLm9uZXJyb3I9bnVsbDsgdGhpcy5zcmM9Jy9hc3NldHMvcGxhY2VfMjRkcF81OTg1RTEucG5nJztcIiAvPlxyXG4gICAgICA8aDM+JHtzdG9yeS5uYW1lIHx8ICdBbm9uaW0nfTwvaDM+XHJcbiAgICAgIDxwPiR7c3RvcnkuZGVzY3JpcHRpb24gfHwgJy0nfTwvcD5cclxuICAgICAgPHA+PHNtYWxsPiR7ZGF0ZX08L3NtYWxsPjwvcD5cclxuICAgICAgPGRpdiBjbGFzcz1cInN0b3J5LWNhcmQtYWN0aW9uc1wiPlxyXG4gICAgICAgIDxidXR0b24gY2xhc3M9XCJzYXZlLWJ0blwiIGRhdGEtaWQ9XCIke3N0b3J5LmlkfVwiICR7aXNTYXZlZCA/ICdkaXNhYmxlZCcgOiAnJ30+XHJcbiAgICAgICAgICAke2lzU2F2ZWQgPyAnVGVyc2ltcGFuJyA6ICdTaW1wYW4nfVxyXG4gICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICR7aXNTYXZlZCA/IGA8YnV0dG9uIGNsYXNzPVwiZGVsZXRlLWJ0blwiIGRhdGEtaWQ9XCIke3N0b3J5LmlkfVwiPkhhcHVzPC9idXR0b24+YCA6ICcnfVxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gIGA7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBdHRhY2ggbGlzdGVuZXIga2UgdG9tYm9sIHNpbXBhbiBkYW4gaGFwdXMgc2V0ZWxhaCBrYXJ0dSBkaXJlbmRlclxyXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBvblNhdmVCb29rbWFya0NhbGxiYWNrIC0gY2FsbGJhY2sga2V0aWthIHRvbWJvbCBzaW1wYW4gZGlrbGlrXHJcbiAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRGVsZXRlU3RvcnlDYWxsYmFjayAtIGNhbGxiYWNrIGtldGlrYSB0b21ib2wgaGFwdXMgZGlrbGlrXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYmluZFNhdmVCdXR0b25zQW5kRGVsZXRlQnV0dG9ucyhvblNhdmVCb29rbWFya0NhbGxiYWNrLCBvbkRlbGV0ZVN0b3J5Q2FsbGJhY2spIHtcclxuICBjb25zdCBzYXZlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zYXZlLWJ0bicpO1xyXG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsZXRlLWJ0bicpO1xyXG5cclxuICAvLyBNZW5naWthdCBldmVudCBsaXN0ZW5lciB1bnR1ayB0b21ib2wgc2ltcGFuXHJcbiAgc2F2ZUJ1dHRvbnMuZm9yRWFjaCgoYnRuKSA9PiB7XHJcbiAgICBjb25zdCBzdG9yeUlkID0gYnRuLmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpO1xyXG4gICAgaWYgKHN0b3J5SWQgJiYgdHlwZW9mIG9uU2F2ZUJvb2ttYXJrQ2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIG9uU2F2ZUJvb2ttYXJrQ2FsbGJhY2soc3RvcnlJZCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAvLyBNZW5naWthdCBldmVudCBsaXN0ZW5lciB1bnR1ayB0b21ib2wgaGFwdXNcclxuICBkZWxldGVCdXR0b25zLmZvckVhY2goKGJ0bikgPT4ge1xyXG4gICAgY29uc3Qgc3RvcnlJZCA9IGJ0bi5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKTtcclxuICAgIGlmIChzdG9yeUlkICYmIHR5cGVvZiBvbkRlbGV0ZVN0b3J5Q2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIG9uRGVsZXRlU3RvcnlDYWxsYmFjayhzdG9yeUlkKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/presenter/storyPresenter.js\n");

/***/ }),

/***/ "./src/utils/map.js":
/*!**************************!*\
  !*** ./src/utils/map.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initLocationPicker: () => (/* binding */ initLocationPicker),\n/* harmony export */   initMapWithStories: () => (/* binding */ initMapWithStories),\n/* harmony export */   removeMap: () => (/* binding */ removeMap)\n/* harmony export */ });\n/* harmony import */ var leaflet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! leaflet */ \"./node_modules/leaflet/dist/leaflet-src.js\");\n/* harmony import */ var leaflet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(leaflet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var leaflet_markercluster__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! leaflet.markercluster */ \"./node_modules/leaflet.markercluster/dist/leaflet.markercluster-src.js\");\n/* harmony import */ var leaflet_markercluster__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(leaflet_markercluster__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var leaflet_markercluster_dist_MarkerCluster_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! leaflet.markercluster/dist/MarkerCluster.css */ \"./node_modules/leaflet.markercluster/dist/MarkerCluster.css\");\n/* harmony import */ var leaflet_markercluster_dist_MarkerCluster_Default_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! leaflet.markercluster/dist/MarkerCluster.Default.css */ \"./node_modules/leaflet.markercluster/dist/MarkerCluster.Default.css\");\n\r\n  // cukup import ini saja\r\n\r\n\r\n\r\nlet mapInstance = null;\r\nlet markerClusterGroup = null;\r\n\r\nfunction initMapWithStories(stories) {\r\n  // Cek apakah elemen map ada\r\n  const mapElement = document.getElementById('map');\r\n  if (!mapElement) {\r\n    console.log('Map element not found');\r\n    return;\r\n  }\r\n\r\n  try {\r\n    if (mapInstance) {\r\n      mapInstance.remove();\r\n      mapInstance = null;\r\n      markerClusterGroup = null;\r\n    }\r\n\r\n    // Cek apakah Leaflet tersedia\r\n    if (typeof (leaflet__WEBPACK_IMPORTED_MODULE_0___default()) === 'undefined') {\r\n      console.error('Leaflet library not available');\r\n      mapElement.innerHTML = '<div style=\"padding: 20px; text-align: center;\">Peta tidak tersedia dalam mode offline</div>';\r\n      return;\r\n    }\r\n\r\n    mapInstance = leaflet__WEBPACK_IMPORTED_MODULE_0___default().map('map').setView([-2.5, 117.5], 5);\r\n\r\n    leaflet__WEBPACK_IMPORTED_MODULE_0___default().tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution: '© OpenStreetMap contributors',\r\n    }).addTo(mapInstance);\r\n\r\n    // Cek apakah MarkerClusterGroup tersedia\r\n    if ((leaflet__WEBPACK_IMPORTED_MODULE_0___default().markerClusterGroup)) {\r\n      markerClusterGroup = leaflet__WEBPACK_IMPORTED_MODULE_0___default().markerClusterGroup();\r\n    } else {\r\n      console.warn('MarkerClusterGroup not available, using normal markers');\r\n      markerClusterGroup = leaflet__WEBPACK_IMPORTED_MODULE_0___default().layerGroup();\r\n    }\r\n\r\n    const locationIcon = (leaflet__WEBPACK_IMPORTED_MODULE_0___default().icon) ? leaflet__WEBPACK_IMPORTED_MODULE_0___default().icon({\r\n      iconUrl: '/assets/place_24dp_5985E1.png',\r\n      iconSize: [32, 32],\r\n      iconAnchor: [16, 32],\r\n      popupAnchor: [0, -32]\r\n    }) : null;\r\n\r\n    stories.forEach(story => {\r\n      if (story.lat !== null && story.lon !== null) {\r\n        const marker = leaflet__WEBPACK_IMPORTED_MODULE_0___default().marker([story.lat, story.lon], { \r\n          icon: locationIcon || undefined \r\n        });\r\n        marker.bindPopup(`\r\n          <strong>${story.name || 'Anonim'}</strong><br>\r\n          ${story.description || '-'}\r\n        `);\r\n        markerClusterGroup.addLayer(marker);\r\n      }\r\n    });\r\n\r\n    mapInstance.addLayer(markerClusterGroup);\r\n  } catch (error) {\r\n    console.error('Error initializing map:', error);\r\n    mapElement.innerHTML = '<div style=\"padding: 20px; text-align: center;\">Terjadi kesalahan saat memuat peta</div>';\r\n  }\r\n}\r\n\r\nfunction initLocationPicker() {\r\n  if (mapInstance) {\r\n    mapInstance.remove();\r\n    mapInstance = null;\r\n  }\r\n\r\n  const defaultLatLng = [-2.5, 117.5];\r\n  mapInstance = leaflet__WEBPACK_IMPORTED_MODULE_0___default().map('map').setView(defaultLatLng, 5);\r\n\r\n  leaflet__WEBPACK_IMPORTED_MODULE_0___default().tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution: '© OpenStreetMap contributors',\r\n  }).addTo(mapInstance);\r\n\r\n  let locationPickerMarker = null;\r\n\r\n  mapInstance.on('click', function (e) {\r\n    const { lat, lng } = e.latlng;\r\n\r\n    if (locationPickerMarker) {\r\n      locationPickerMarker.setLatLng(e.latlng);\r\n    } else {\r\n      locationPickerMarker = leaflet__WEBPACK_IMPORTED_MODULE_0___default().marker(e.latlng, { icon: locationIcon }).addTo(mapInstance);\r\n    }\r\n\r\n    window.selectedLocation = { lat, lon: lng };\r\n  });\r\n}\r\n\r\nfunction removeMap() {\r\n  if (mapInstance) {\r\n    mapInstance.remove();\r\n    mapInstance = null;\r\n    markerClusterGroup = null;\r\n  }\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvbWFwLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF3QjtBQUNPLEVBQUU7QUFDcUI7QUFDUTtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnREFBQztBQUNoQjtBQUNBLHlEQUF5RCxtQkFBbUI7QUFDNUU7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGtEQUFLO0FBQ3ZCO0FBQ0EsSUFBSSx3REFBVyxXQUFXLEVBQUUseUJBQXlCLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRTtBQUMvRDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsUUFBUSxtRUFBb0I7QUFDNUIsMkJBQTJCLGlFQUFvQjtBQUMvQyxNQUFNO0FBQ047QUFDQSwyQkFBMkIseURBQVk7QUFDdkM7QUFDQTtBQUNBLHlCQUF5QixxREFBTSxHQUFHLG1EQUFNO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixxREFBUTtBQUMvQjtBQUNBLFNBQVM7QUFDVDtBQUNBLG9CQUFvQix1QkFBdUI7QUFDM0MsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsdURBQXVELG1CQUFtQjtBQUMxRTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrREFBSztBQUNyQjtBQUNBLEVBQUUsd0RBQVcsV0FBVyxFQUFFLHlCQUF5QixFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUU7QUFDN0Q7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFdBQVc7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLDZCQUE2QixxREFBUSxhQUFhLG9CQUFvQjtBQUN0RTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDLEdBQUc7QUFDSDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jZXJpdGFhcHAvLi9zcmMvdXRpbHMvbWFwLmpzPzA5Y2IiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEwgZnJvbSAnbGVhZmxldCc7XHJcbmltcG9ydCAnbGVhZmxldC5tYXJrZXJjbHVzdGVyJzsgIC8vIGN1a3VwIGltcG9ydCBpbmkgc2FqYVxyXG5pbXBvcnQgJ2xlYWZsZXQubWFya2VyY2x1c3Rlci9kaXN0L01hcmtlckNsdXN0ZXIuY3NzJztcclxuaW1wb3J0ICdsZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvZGlzdC9NYXJrZXJDbHVzdGVyLkRlZmF1bHQuY3NzJztcclxuXHJcbmxldCBtYXBJbnN0YW5jZSA9IG51bGw7XHJcbmxldCBtYXJrZXJDbHVzdGVyR3JvdXAgPSBudWxsO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGluaXRNYXBXaXRoU3RvcmllcyhzdG9yaWVzKSB7XHJcbiAgLy8gQ2VrIGFwYWthaCBlbGVtZW4gbWFwIGFkYVxyXG4gIGNvbnN0IG1hcEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyk7XHJcbiAgaWYgKCFtYXBFbGVtZW50KSB7XHJcbiAgICBjb25zb2xlLmxvZygnTWFwIGVsZW1lbnQgbm90IGZvdW5kJyk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgaWYgKG1hcEluc3RhbmNlKSB7XHJcbiAgICAgIG1hcEluc3RhbmNlLnJlbW92ZSgpO1xyXG4gICAgICBtYXBJbnN0YW5jZSA9IG51bGw7XHJcbiAgICAgIG1hcmtlckNsdXN0ZXJHcm91cCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2VrIGFwYWthaCBMZWFmbGV0IHRlcnNlZGlhXHJcbiAgICBpZiAodHlwZW9mIEwgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0xlYWZsZXQgbGlicmFyeSBub3QgYXZhaWxhYmxlJyk7XHJcbiAgICAgIG1hcEVsZW1lbnQuaW5uZXJIVE1MID0gJzxkaXYgc3R5bGU9XCJwYWRkaW5nOiAyMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+UGV0YSB0aWRhayB0ZXJzZWRpYSBkYWxhbSBtb2RlIG9mZmxpbmU8L2Rpdj4nO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbWFwSW5zdGFuY2UgPSBMLm1hcCgnbWFwJykuc2V0VmlldyhbLTIuNSwgMTE3LjVdLCA1KTtcclxuXHJcbiAgICBMLnRpbGVMYXllcignaHR0cHM6Ly97c30udGlsZS5vcGVuc3RyZWV0bWFwLm9yZy97en0ve3h9L3t5fS5wbmcnLCB7XHJcbiAgICAgIGF0dHJpYnV0aW9uOiAnwqkgT3BlblN0cmVldE1hcCBjb250cmlidXRvcnMnLFxyXG4gICAgfSkuYWRkVG8obWFwSW5zdGFuY2UpO1xyXG5cclxuICAgIC8vIENlayBhcGFrYWggTWFya2VyQ2x1c3Rlckdyb3VwIHRlcnNlZGlhXHJcbiAgICBpZiAoTC5tYXJrZXJDbHVzdGVyR3JvdXApIHtcclxuICAgICAgbWFya2VyQ2x1c3Rlckdyb3VwID0gTC5tYXJrZXJDbHVzdGVyR3JvdXAoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignTWFya2VyQ2x1c3Rlckdyb3VwIG5vdCBhdmFpbGFibGUsIHVzaW5nIG5vcm1hbCBtYXJrZXJzJyk7XHJcbiAgICAgIG1hcmtlckNsdXN0ZXJHcm91cCA9IEwubGF5ZXJHcm91cCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGxvY2F0aW9uSWNvbiA9IEwuaWNvbiA/IEwuaWNvbih7XHJcbiAgICAgIGljb25Vcmw6ICcvYXNzZXRzL3BsYWNlXzI0ZHBfNTk4NUUxLnBuZycsXHJcbiAgICAgIGljb25TaXplOiBbMzIsIDMyXSxcclxuICAgICAgaWNvbkFuY2hvcjogWzE2LCAzMl0sXHJcbiAgICAgIHBvcHVwQW5jaG9yOiBbMCwgLTMyXVxyXG4gICAgfSkgOiBudWxsO1xyXG5cclxuICAgIHN0b3JpZXMuZm9yRWFjaChzdG9yeSA9PiB7XHJcbiAgICAgIGlmIChzdG9yeS5sYXQgIT09IG51bGwgJiYgc3RvcnkubG9uICE9PSBudWxsKSB7XHJcbiAgICAgICAgY29uc3QgbWFya2VyID0gTC5tYXJrZXIoW3N0b3J5LmxhdCwgc3RvcnkubG9uXSwgeyBcclxuICAgICAgICAgIGljb246IGxvY2F0aW9uSWNvbiB8fCB1bmRlZmluZWQgXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbWFya2VyLmJpbmRQb3B1cChgXHJcbiAgICAgICAgICA8c3Ryb25nPiR7c3RvcnkubmFtZSB8fCAnQW5vbmltJ308L3N0cm9uZz48YnI+XHJcbiAgICAgICAgICAke3N0b3J5LmRlc2NyaXB0aW9uIHx8ICctJ31cclxuICAgICAgICBgKTtcclxuICAgICAgICBtYXJrZXJDbHVzdGVyR3JvdXAuYWRkTGF5ZXIobWFya2VyKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgbWFwSW5zdGFuY2UuYWRkTGF5ZXIobWFya2VyQ2x1c3Rlckdyb3VwKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW5pdGlhbGl6aW5nIG1hcDonLCBlcnJvcik7XHJcbiAgICBtYXBFbGVtZW50LmlubmVySFRNTCA9ICc8ZGl2IHN0eWxlPVwicGFkZGluZzogMjBweDsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlRlcmphZGkga2VzYWxhaGFuIHNhYXQgbWVtdWF0IHBldGE8L2Rpdj4nO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGluaXRMb2NhdGlvblBpY2tlcigpIHtcclxuICBpZiAobWFwSW5zdGFuY2UpIHtcclxuICAgIG1hcEluc3RhbmNlLnJlbW92ZSgpO1xyXG4gICAgbWFwSW5zdGFuY2UgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgZGVmYXVsdExhdExuZyA9IFstMi41LCAxMTcuNV07XHJcbiAgbWFwSW5zdGFuY2UgPSBMLm1hcCgnbWFwJykuc2V0VmlldyhkZWZhdWx0TGF0TG5nLCA1KTtcclxuXHJcbiAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8ve3N9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJywge1xyXG4gICAgYXR0cmlidXRpb246ICfCqSBPcGVuU3RyZWV0TWFwIGNvbnRyaWJ1dG9ycycsXHJcbiAgfSkuYWRkVG8obWFwSW5zdGFuY2UpO1xyXG5cclxuICBsZXQgbG9jYXRpb25QaWNrZXJNYXJrZXIgPSBudWxsO1xyXG5cclxuICBtYXBJbnN0YW5jZS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgY29uc3QgeyBsYXQsIGxuZyB9ID0gZS5sYXRsbmc7XHJcblxyXG4gICAgaWYgKGxvY2F0aW9uUGlja2VyTWFya2VyKSB7XHJcbiAgICAgIGxvY2F0aW9uUGlja2VyTWFya2VyLnNldExhdExuZyhlLmxhdGxuZyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsb2NhdGlvblBpY2tlck1hcmtlciA9IEwubWFya2VyKGUubGF0bG5nLCB7IGljb246IGxvY2F0aW9uSWNvbiB9KS5hZGRUbyhtYXBJbnN0YW5jZSk7XHJcbiAgICB9XHJcblxyXG4gICAgd2luZG93LnNlbGVjdGVkTG9jYXRpb24gPSB7IGxhdCwgbG9uOiBsbmcgfTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZU1hcCgpIHtcclxuICBpZiAobWFwSW5zdGFuY2UpIHtcclxuICAgIG1hcEluc3RhbmNlLnJlbW92ZSgpO1xyXG4gICAgbWFwSW5zdGFuY2UgPSBudWxsO1xyXG4gICAgbWFya2VyQ2x1c3Rlckdyb3VwID0gbnVsbDtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/utils/map.js\n");

/***/ })

}]);